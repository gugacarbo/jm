<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sobre - Jm Acessórios de Luxo</title>
    <link rel="icon" href="/img/Jm_Logo_Branco.png">
    <link rel="stylesheet" href="../css/main.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    
    <link href="https://cdn.jsdelivr.net/npm/glider-js@1/glider.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/glider-js@1/glider.min.js"></script>
    <script src="https://kit.fontawesome.com/dd47628d23.js" crossorigin="anonymous"></script>
</head>
<body>
    <header></header>

    <div class="Banner">
        <div id="AboutSlider" class="bannerShow">
        </div>
        <div role="tablist" class="dotsBanner"></div>
    </div>
    <div class="about">
        <section id="aboutText">
        </section>
        <div>
            <div class="img">
                <img src="aboutImage.jpg" id="aboutImg">
            </div>
            <div class="map" id="mapL">
            </div>
        </div>
    </div>
    <footer>
    </footer>
    <script>
        $(document).ready(() => {
            $("header").load("/includes/header.html");
            $("footer").load("/includes/footer.html");
            
            setBanner("#AboutSlider", "ABOUT_BANNER");
            


            var http = new XMLHttpRequest();
            http.open('HEAD', "aboutFile.ino", false);
            http.send();
            if (http.status == 404) {
                $("#aboutText").html("<span>Ocorreu um erro ao carregar o conteúdo da página.</span>");
            }else{
                $("#aboutText").load("aboutFile.ino?nocache=" + (new Date()).getTime());
            }
            
        
            var http = new XMLHttpRequest();
            http.open('HEAD', "aboutImage.jpg", false);
            http.send();
            if (http.status == 404) {
                $("#aboutImg").parent().remove()
                $("#mapL").css("width", "100%")
                $("#mapL").css("height", "500px")
            }else{
                $("#aboutImg").attr("src", "aboutImage.jpg?nocache=" + Math.random());
            }


            var http = new XMLHttpRequest();
            http.open('HEAD', "mapLink.ino", false);
            http.send();
            if (http.status == 404) {
                $("#mapL").remove()
                //$("#aboutImg").parent().css("width", "100%")
                $("#aboutImg").parent().css("width", "100%")
                $("#aboutImg").css("width", "100%")
            }else{
                $("#mapL").load("mapLink.ino?nocache=" + Math.random());
            }
        })
        function setBanner(el_id, banner_name) {
            //"/api/getBanner.php"
            return $.get("/api/get/getBanner.php", { 'name': banner_name }, function (data) {
            
                var images = (data["images"]);
                $.each(images, function (i, img) {
                    if (img != "")
                        $(el_id).append("<img src='" + img + "'>");
                });
            }).then((value) => {
                callBanner();
            })
        }
        function callBanner(el_id) {
            var about = new Glider(document.querySelector("#AboutSlider"), {
                slidesToShow: 1,
                slidesToScroll: 1,
                draggable: false,
                dragVelocity: 2,
                dots: '.dotsBanner',
                duration: 3,
                rewind: true,
            });
            sliderAuto(about, 1500)
        }
        function sliderAuto(slider, miliseconds) {
            const slidesCount = slider.track.childElementCount;
            let slideTimeout = null;
            let nextIndex = 1;
            function slide() {
                slideTimeout = setTimeout(
                    function () {
                        nextIndex = slider.slide + 1;
                        if (nextIndex >= slidesCount) {
                            nextIndex = 0;
                        }
                        slider.scrollItem(nextIndex);
                    },
                    miliseconds
                );
            }
            slider.ele.addEventListener('glider-animated', function () {
                window.clearInterval(slideTimeout);
                slide();
            });
            slide();
        }
    </script>

    
</body>

</html>