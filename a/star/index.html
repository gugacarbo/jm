<!DOCTYPE html>
<html>
<head>
      <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body style="font-family: Arial, Helvetica, sans-serif; display:flex; flex-direction:column; align-items:center;">
      <h2>Fitas de led rgb</h2>
      <input id="colorPicker1" value="#%rgb1%" data-jscolor="{}">
      <input id="colorPicker2" value="#%rgb2%" data-jscolor="{}">
      <input id="colorPicker3" value="#%rgb3%" data-jscolor="{}">
      <h2>Fitas de led brancas</h2>
      <input id="range1" type="range" value="%white1%" min="0" max="100">
      <input id="range2" type="range" value="%white2%" min="0" max="100">
      <input id="range3" type="range" value="%white3%" min="0" max="100">
      <br/>
      <br/>
      <button id="changeButton" onclick="onClick()">Mudar</button>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jscolor/2.4.5/jscolor.min.js"></script>

      <script>
            //Recuperamos os colorpickers que serão utilizados para modificar as fitas de led rgb
            var colorPicker1 = document.getElementById("colorPicker1");
            var colorPicker2 = document.getElementById("colorPicker2");
            var colorPicker3 = document.getElementById("colorPicker3");
            //Recuperamos os ranges que serão utilizados para modificar as fitas de led brancas
            var range1 = document.getElementById("range1");
            var range2 = document.getElementById("range2");
            var range3 = document.getElementById("range3");
            //Esta função é executada quando se clica no botão "Mudar"
            function onClick() {
                  //Pegamos os valores do rgb em hexadecimal (retiramos o "#" já que não precisamos")
                  var rgb1 = colorPicker1.value.replace("#", "");
                  var rgb2 = colorPicker2.value.replace("#", "");
                  var rgb3 = colorPicker3.value.replace("#", "");
                  
                  //Pegamos os valores dos ranges
                  var white1 = range1.value;
                  var white2 = range2.value;
                  var white3 = range3.value;
                  //Enviamos os valores para o ESP
                  post(rgb1, rgb2, rgb3, white1, white2, white3);
            }
            function post(rgb1, rgb2, rgb3, white1, white2, white3) {
                  //Cria uma requisição
                  var xhr = new XMLHttpRequest();
                  //A url que colocamos no ESP para receber os valores dos leds
                  var url = "/api/led";
                  //Os dados das fitas que vamos enviar
                  var data = `rgb1=${rgb1}&rgb2=${rgb2}&rgb3=${rgb3}&white1=${white1}&white2=${white2}&white3=${white3}`;
                  //Enviamos como post
                  xhr.open("POST", url, true);
                  //Indicamos como a requisição está enviando os dados
                  xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                  //Esta função será executada quando terminarmos de receber a resposta do ESP
                  xhr.onload = function () {
                        console.log(xhr.responseText);
                  };
                  //Enviamos os dados dos leds
                  xhr.send(data);
            }
      </script>
</body>
</html>